# 第三章 系统总线考点总结

本章主要介绍了计算机系统总线的基本概念、类型、通信方式、仲裁方式以及总线的性能参数等内容。以下是对本章主要考点的详细总结。

---

## 1. 总线的概念与作用

### 1.1 总线的定义

- **总线**：计算机系统中，各个部件之间传输信息的公共通信线路的集合。

### 1.2 总线的优点

- **模块化设计（积木化）**：使用总线结构便于增减外设，提升系统的灵活性和可扩展性。
- **减少信号线数量**：总线结构共享通信线路，降低了系统的复杂度和成本。

### 1.3 总线的缺点

- **竞争与冲突**：由于多设备共享总线，可能导致总线争用，需要仲裁机制。
- **传输速率限制**：总线带宽可能成为系统性能的瓶颈。

---

## 2. 总线的分类

### 2.1 按传输内容分类

- **数据总线（Data Bus）**：用于传输数据和指令信息。
- **地址总线（Address Bus）**：用于指定内存单元或I/O设备的地址。
- **控制总线（Control Bus）**：用于传输控制信号和时序信号，以及接收设备的响应信号。

### 2.2 按总线的用途分类

- **系统总线**：连接CPU、内存和I/O设备的主要通道。
- **通信总线**：用于计算机之间的通信，如网络总线。
- **局部总线**：连接特定设备的高速通道，如AGP、PCI总线。

---

## 3. 总线的结构与传输方式

### 3.1 并行传输与串行传输

- **并行传输**：
  
  - 同时传输多个比特位，速度较快。
  - 需要较多的信号线，成本高。

- **串行传输**：
  
  - 一次传输一位，信号线少，适合长距离传输。
  - 现代高速串行总线（如PCIe）传输速率高于传统并行总线。

### 3.2 总线复用技术

- **复用传输**：
  
  - 地址信号和数据信号共享同一组信号线，分时传输。
  - **优点**：减少了信号线数量，降低成本。
  - **缺点**：可能增加传输时延。

### 3.3 突发（猝发）传输

- **概念**：在一次总线事务中，只需提供一个首地址，之后连续传输多个数据，提高数据传输效率。

- **优点**：减少总线仲裁次数，提高总线利用率和数据传输速率。

---

## 4. 总线的通信控制方式

### 4.1 同步通信方式

- **特点**：
  
  - 由统一的时钟信号控制数据传输，各部件按照固定时序操作。
  - 传输过程：通常先传输地址，再传输数据。

- **优点**：时序简单，易于实现高速传输。

- **缺点**：缺乏灵活性，时钟偏差可能导致传输错误。

### 4.2 异步通信方式

- **特点**：
  
  - 不依赖统一的时钟信号，采用握手（应答）信号进行同步。
  - 适用于各部件速度不一致的情况。

- **类型**：
  
  - **全互锁**：发送方和接收方每一步操作都需对方确认，最可靠但速度最慢。
  - **半互锁**：部分步骤进行握手确认，兼顾速度和可靠性。
  - **不互锁**：无握手过程，速度最快，但可靠性最低。

### 4.3 半同步（半异步）通信方式

- **特点**：结合同步和异步的优点，利用同步时钟控制数据传输，使用握手信号进行确认。

- **应用**：在需要一定同步性的同时，又要求灵活性的场合。

---

## 5. 总线仲裁方式

当多个设备同时请求使用总线时，需要仲裁机制来决定谁获得总线控制权。

### 5.1 集中式仲裁

- **由中央仲裁器（如CPU或专门的总线控制器）负责仲裁。**

#### 5.1.1 链式查询（Daisy Chain）

- **特点**：
  
  - 各设备按照优先级高低串联，仲裁信号依次传递。
  - **优点**：实现简单，控制线少。
  - **缺点**：响应速度慢，对电路故障敏感，上游设备故障会影响下游设备。

#### 5.1.2 计数器定时查询

- **特点**：
  
  - 使用计数器循环查询各设备的请求信号。
  
  - **方式**：
    
    - **固定优先级**：计数器每次从0开始，设备号小的优先级高。
    - **轮询优先级**：计数器从上次停止的位置开始，所有设备使用总线的机会相等。

- **优点**：公平性高。

- **缺点**：响应速度受限于轮询周期。

#### 5.1.3 独立请求方式

- **特点**：
  
  - 每个设备都有独立的总线请求和响应线。
  - **优点**：响应速度快，优先级灵活。
  - **缺点**：需要大量的控制线，硬件成本高。

### 5.2 分布式仲裁

- **各设备自行参与仲裁，无中央仲裁器。**

- **特点**：提高了系统的灵活性和可靠性，但实现复杂。

---

## 6. 总线性能参数

### 6.1 总线宽度

- **定义**：总线一次传输的数据位数，通常以位（bit）为单位。

- **影响**：总线宽度越大，数据传输速率越高。

### 6.2 时钟频率

- **定义**：同步总线的工作频率，决定了数据传输的时序。

- **影响**：频率越高，总线传输速度越快，但对信号完整性要求更高。

### 6.3 数据传输率（带宽）

- **计算公式**：
  
  $[
  \text{总线带宽} = \text{总线宽度} \times \text{时钟频率} \times \text{传输效率}
  ]$

- **影响因素**：
  
  - 总线宽度和时钟频率。
  - 传输方式（如突发传输、复用传输）。
  - 数据有效传输时间占总时间的比例。

### 6.4 传输效率

- **提高方法**：
  
  - **增加总线宽度**：如从32位提高到64位。
  - **提高时钟频率**：需要克服信号完整性和电磁干扰问题。
  - **支持突发传输**：减少总线仲裁和地址传输时间。
  - **双倍数据速率（DDR）技术**：在时钟上升沿和下降沿均传输数据。

---

## 7. 常见总线标准

### 7.1 PCI总线（Peripheral Component Interconnect）

- **特点**：
  
  - 高速、独立于处理器的外部总线。
  - 支持总线复用，减少信号线数量。
  - 可支持多条PCI总线，灵活扩展。

### 7.2 USB总线（Universal Serial Bus）

- **特点**：
  
  - 串行总线标准，支持即插即用和热插拔。
  - 连接外部设备的常用总线，如键盘、鼠标、U盘等。
  - 提供电源供给，方便小型设备使用。

### 7.3 AGP总线（Accelerated Graphics Port）

- **特点**：
  
  - 专用于显卡的高速局部总线。
  - 提高图形数据传输速率，满足3D绘图需求。

### 7.4 RS-232总线

- **特点**：
  
  - 早期的串行通信接口标准。
  - 支持长距离通信，可通过电话线传输。

---

## 8. 总线设计的关键问题

### 8.1 信号线数量与传输速率的平衡

- **信号线越多**：
  
  - 并行传输速度快，但成本高，信号同步困难。
  - **现代趋势**：采用高速串行传输（如PCIe），在减少信号线的同时提高传输速率。

### 8.2 信号完整性

- **高速传输中的问题**：
  
  - 信号反射、串扰和时钟偏移。
  - 需要考虑阻抗匹配、差分信号等技术。

### 8.3 总线利用率

- **提高方法**：
  
  - **突发传输**：减少每次传输的开销。
  - **分离事务（Split Transaction）**：允许总线在等待期间执行其他操作，提高利用率。

---

## 9. 典型计算与分析

### 9.1 总线带宽计算

**示例**：

- **已知**：
  
  - 总线时钟频率：100MHz
  - 总线宽度：32位
  - 地址/数据线复用
  - 每传输一个地址或数据占用一个时钟周期
  - 支持突发传输

- **问题**：一次"主存写"总线事务传输128位数据需要的最少时间？

- **分析**：
  
  - 传输地址：1个时钟周期
  - 传输数据：128位 / 32位 = 4个数据，需4个时钟周期
  - **总时间**：1 + 4 = 5个时钟周期
  - **总时间**：5个周期 × 10ns（100MHz时钟周期） = 50ns

### 9.2 异步串行传输波特率与比特率计算

**示例**：

- **已知**：
  
  - 每秒传输120个数据帧
  - 字符格式：1位起始位、8位数据位、1位校验位、1位终止位
  - **问题**：波特率是多少？

- **计算**：
  
  - 每帧比特数：1 + 8 + 1 + 1 = 11位
  - 每秒传输比特数：120帧 × 11位 = 1320位
  - **波特率**：1320波特

---

## 10. 其他重要概念

### 10.1 总线的传输内容划分

- **根据传输内容**：
  
  - **数据线、地址线和控制线**：用于不同类型信息的传输。

### 10.2 总线事务和周期

- **总线事务**：完成一次总线操作所需的总线活动，包括请求、仲裁、传输和释放。

- **总线周期**：总线上完成一次基本操作所需的时间。

### 10.3 多处理器系统中的总线通信

- **共享内存访问**：
  
  - 需要采用适当的联络方式（如半互锁）以确保数据一致性和同步。

### 10.4 总线故障敏感性

- **链式查询方式**：
  
  - 对电路故障最敏感，一个设备的故障可能影响整个链路。

---

## 11. 总结

- **总线设计**是计算机系统结构中的关键环节，影响系统的性能、成本和可靠性。

- **现代总线技术**倾向于：
  
  - **高速串行传输**：如PCI Express，提高了数据传输速率，减少了信号线数量。
  
  - **总线复用和突发传输**：提高总线利用率，降低成本。

- **总线仲裁和通信方式**需要在速度、成本和可靠性之间进行权衡。

---

-by Daywaste


